/***********************************************************************
 * Copyright (c) 2025 Bank of Italy                                    *
 * Distributed under the MIT software license, see the accompanying    *
 * file COPYING or https://www.opensource.org/licenses/mit-license.php.*
 ***********************************************************************/

#ifndef SECP256K1_MODULE_FROST_TESTS_BIGINT_MOD_P_H
#define SECP256K1_MODULE_FROST_TESTS_BIGINT_MOD_P_H

/* ************ Test Vector for testing bigint functionality ********** *
 *  Values generated with:                                              *
 *  tools/test_vectors_h2c_reduce_bigint_mod_p_generate.py              */
static bigint_internal bigint_mod_p_test_vector_expected_input_0 = {
    {0x0000000000000000},
    1
};

static unsigned char bigint_mod_p_test_vector_expected_output_0[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* a = 1 */
static bigint_internal bigint_mod_p_test_vector_expected_input_1 = {
    {0x0000000000000001},
    1
};
static unsigned char bigint_mod_p_test_vector_expected_output_1[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01
};

/* a = p - 1 */
static bigint_internal bigint_mod_p_test_vector_expected_input_2 = {
    {0xfffffffefffffc2e, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff},
    4
};
static unsigned char bigint_mod_p_test_vector_expected_output_2[32] = {
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2e
};

/* a = p */
static bigint_internal bigint_mod_p_test_vector_expected_input_3 = {
    {0xfffffffefffffc2f, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff},
    4
};
static unsigned char bigint_mod_p_test_vector_expected_output_3[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* a = p + 1 */
static bigint_internal bigint_mod_p_test_vector_expected_input_4 = {
    {0xfffffffefffffc30, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff},
    4
};
static unsigned char bigint_mod_p_test_vector_expected_output_4[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01
};

/* a = 2 * p */
static bigint_internal bigint_mod_p_test_vector_expected_input_5 = {
    {
        0xfffffffdfffff85e, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff,
        0x0000000000000001
    },
    5
};
static unsigned char bigint_mod_p_test_vector_expected_output_5[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* a = p - 2 */
static bigint_internal bigint_mod_p_test_vector_expected_input_6 = {
    {0xfffffffefffffc2d, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff},
    4
};
static unsigned char bigint_mod_p_test_vector_expected_output_6[32] = {
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xfe, 0xff, 0xff, 0xfc, 0x2d
};

/* a = p + 2 */
static bigint_internal bigint_mod_p_test_vector_expected_input_7 = {
    {0xfffffffefffffc31, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff},
    4
};
static unsigned char bigint_mod_p_test_vector_expected_output_7[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02
};

/* a = 3 * p */
static bigint_internal bigint_mod_p_test_vector_expected_input_8 = {
    {
        0xfffffffcfffff48d, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff,
        0x0000000000000002
    },
    5
};
static unsigned char bigint_mod_p_test_vector_expected_output_8[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* a = p^2 mod p (should be 0) */
static bigint_internal bigint_mod_p_test_vector_expected_input_9 = {
    {
        0x000007a2000e90a1, 0x0000000000000001, 0x0000000000000000, 0x0000000000000000,
        0xfffffffdfffff85e, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff
    },
    8
};
static unsigned char bigint_mod_p_test_vector_expected_output_9[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/* a = 2^384 - 1 */
static bigint_internal bigint_mod_p_test_vector_expected_input_10 = {
    {
        0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff,
        0xffffffffffffffff, 0xffffffffffffffff
    },
    6
};
static unsigned char bigint_mod_p_test_vector_expected_output_10[32] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
    0x00, 0x00, 0x03, 0xd0, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff
};

/* a = random 48-byte */
static bigint_internal bigint_mod_p_test_vector_expected_input_11 = {
    {
        0x0123456789abcdef, 0x0123456789abcdef, 0x0123456789abcdef, 0x0123456789abcdef,
        0x0123456789abcdef, 0x0123456789abcdef
    },
    6
};
static unsigned char bigint_mod_p_test_vector_expected_output_11[32] = {
    0x01, 0x23, 0x45, 0x67, 0x89, 0xab, 0xcd, 0xef, 0x01, 0x23, 0x45, 0x67,
    0x8a, 0xcf, 0x13, 0x5a, 0xe2, 0x6a, 0xf3, 0x7a, 0xf3, 0x7c, 0x00, 0x79,
    0xe2, 0x6a, 0xf3, 0x7a, 0xf2, 0x58, 0xbb, 0x0e
};

static int bigint_mod_p_test_vector_total_tests = 12;

static bigint_internal* bigint_mod_p_test_vector_inputs[] = {
    &bigint_mod_p_test_vector_expected_input_0,
    &bigint_mod_p_test_vector_expected_input_1,
    &bigint_mod_p_test_vector_expected_input_2,
    &bigint_mod_p_test_vector_expected_input_3,
    &bigint_mod_p_test_vector_expected_input_4,
    &bigint_mod_p_test_vector_expected_input_5,
    &bigint_mod_p_test_vector_expected_input_6,
    &bigint_mod_p_test_vector_expected_input_7,
    &bigint_mod_p_test_vector_expected_input_8,
    &bigint_mod_p_test_vector_expected_input_9,
    &bigint_mod_p_test_vector_expected_input_10,
    &bigint_mod_p_test_vector_expected_input_11
};

unsigned char* bigint_mod_p_test_vector_outputs[] = {bigint_mod_p_test_vector_expected_output_0,
                                                     bigint_mod_p_test_vector_expected_output_1,
                                                     bigint_mod_p_test_vector_expected_output_2,
                                                     bigint_mod_p_test_vector_expected_output_3,
                                                     bigint_mod_p_test_vector_expected_output_4,
                                                     bigint_mod_p_test_vector_expected_output_5,
                                                     bigint_mod_p_test_vector_expected_output_6,
                                                     bigint_mod_p_test_vector_expected_output_7,
                                                     bigint_mod_p_test_vector_expected_output_8,
                                                     bigint_mod_p_test_vector_expected_output_9,
                                                     bigint_mod_p_test_vector_expected_output_10,
                                                     bigint_mod_p_test_vector_expected_output_11};

#endif /* SECP256K1_MODULE_FROST_TESTS_BIGINT_MOD_P_H */
